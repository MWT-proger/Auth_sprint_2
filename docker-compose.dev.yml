version: "3.8"

services:

  auth-dev-db:
    image: postgres:14-alpine
    volumes:
      - postgres_auth_data:/var/lib/postgresql/data/
      - ./postgre/create_schema.sql:/docker-entrypoint-initdb.d/create_schema.sql
    env_file:
      - .env.db
    ports:
      - "5433:5433"
    command: -p 5433

  auth-dev-app:
    build:
      context: ./auth
      dockerfile: Dockerfile.dev
    volumes:
      - ./auth/:/usr/src/auth/
    ports:
      - "5000:5000"
    command: python app/main.py
    env_file:
      - .env.dev
    depends_on:
      - auth-db

volumes:
  postgres_auth_data:
